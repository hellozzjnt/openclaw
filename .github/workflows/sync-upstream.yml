name: Sync from upstream

on:
  workflow_dispatch: {}
  schedule:
    - cron: "30 0 * * *"  # 每天 UTC 3 点自动同步，可以改时间
    - cron: "30 12 * * *"
                                                                  
jobs:                                                                                   
    sync:                                                                                 
      runs-on: ubuntu-latest                                                              
                                                                                          
      permissions:                                                                        
        contents: write                                                                   
                                                                                          
      steps:                                                                              
        - name: Checkout fork                                                             
          uses: actions/checkout@v4                                                       
          with:                                                                           
            fetch-depth: 0  # 获取完整历史，用于合并                                      
                                                                                          
        - name: Set up git                                                                
          run: |                                                                          
            git config user.name "github-actions[bot]"                                    
            git config user.email "41898282+github-actions[bot]@users.noreply.github.com" 
                                                                                          
        - name: Add upstream and fetch                                                    
          run: |                                                                          
            git remote add upstream https://github.com/openclaw/openclaw.git              
            git fetch upstream                                                            
                                                                                          
        - name: Merge upstream/main into fork main                                        
          run: |                                                                          
            git checkout main                                                             
            git merge upstream/main --no-edit                                             
                                                                                          
        - name: Push changes to origin                                                    
          run: |                                                                          
            git push origin main
